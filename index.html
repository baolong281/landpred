<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Landmark Prediction of a Survival Outcome • landpred</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Landmark Prediction of a Survival Outcome">
<meta name="description" content="Provides functions for landmark prediction of a survival outcome incorporating covariate and short-term event information. For more information about landmark prediction please see: Parast, Layla, Su-Chun Cheng, and Tianxi Cai. Incorporating short-term outcome information to predict long-term survival with discrete markers. Biometrical Journal 53.2 (2011): 294-307, &lt;doi:10.1002/bimj.201000150&gt;.">
<meta property="og:description" content="Provides functions for landmark prediction of a survival outcome incorporating covariate and short-term event information. For more information about landmark prediction please see: Parast, Layla, Su-Chun Cheng, and Tianxi Cai. Incorporating short-term outcome information to predict long-term survival with discrete markers. Biometrical Journal 53.2 (2011): 294-307, &lt;doi:10.1002/bimj.201000150&gt;.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">landpred</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="landpred">landpred<a class="anchor" aria-label="anchor" href="#landpred"></a>
</h1></div>
<!-- badges: start -->

<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This landpred package provides nonparametric models for landmark prediction of long-term survival outcomes, incorporating covariate and short-term event information. The package supports the construction of flexible varying-coefficient models that use discrete covariates, as well as multiple continuous covariates. The goal is to improve prediction accuracy when censored short-term events are available as predictors, using robust nonparametric procedures that don’t require correct model specification and avoid restrictive parametric assumptions found in existing multistate survival methods. More information on these models can be found in Parast et al. (2012, Journal of the American Statistical Association, <a href="doi:10.1080/01621459.2012.721281" class="uri">doi:10.1080/01621459.2012.721281</a>), and Parast et al. (2011, Biometrical Journal, <a href="https://doi.org/10.1002/bimj.201000150" class="external-link uri">https://doi.org/10.1002/bimj.201000150</a>).</p>
</div>
</div>
<div class="section level1">
<h1 id="tutorial">Tutorial<a class="anchor" aria-label="anchor" href="#tutorial"></a>
</h1>
<div class="section level2">
<h2 id="generating-data">Generating Data<a class="anchor" aria-label="anchor" href="#generating-data"></a>
</h2>
<p>We will generate a dataframe with two continuous covariates, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mn>1</mn></msub><mo>,</mo><msub><mi>Z</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">Z_1,Z_2</annotation></semantics></math>, and one discrete covariate, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>. We will also have a censored short event <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>S</mi></msub><annotation encoding="application/x-tex">X_S</annotation></semantics></math> and a censored long event, our outcome, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>L</mi></msub><annotation encoding="application/x-tex">X_L</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="co"># Generate covariates</span></span>
<span><span class="va">Z1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">Z2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span>  <span class="co"># Binary discrete covariate</span></span>
<span></span>
<span><span class="co"># Generate event times based on exponential model</span></span>
<span><span class="va">X_L_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span>, rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> <span class="va">Z1</span> <span class="op">+</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">Z2</span> <span class="op">+</span> <span class="fl">0.4</span> <span class="op">*</span> <span class="va">B</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">X_S_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span>, rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">0.2</span> <span class="op">*</span> <span class="va">Z1</span> <span class="op">-</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">Z2</span> <span class="op">-</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">B</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate censoring times</span></span>
<span><span class="va">C_L</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">2</span>, <span class="fl">8</span><span class="op">)</span>  <span class="co"># censoring for long event</span></span>
<span><span class="va">C_S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>  <span class="co"># censoring for short event</span></span>
<span></span>
<span><span class="co"># Apply censoring</span></span>
<span><span class="va">X_L</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">X_L_raw</span>, <span class="va">C_L</span><span class="op">)</span></span>
<span><span class="va">D_L</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">X_L_raw</span> <span class="op">&lt;=</span> <span class="va">C_L</span><span class="op">)</span>  <span class="co"># 1 if event, 0 if censored</span></span>
<span></span>
<span><span class="va">X_S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">X_S_raw</span>, <span class="va">C_S</span><span class="op">)</span></span>
<span><span class="va">D_S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">X_S_raw</span> <span class="op">&lt;=</span> <span class="va">C_S</span><span class="op">)</span>  <span class="co"># 1 if event, 0 if censored</span></span>
<span></span>
<span><span class="co"># Return simple data frame</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  X_L <span class="op">=</span> <span class="va">X_L</span>,       <span class="co"># long event time</span></span>
<span>  D_L <span class="op">=</span> <span class="va">D_L</span>,       <span class="co"># long event indicator</span></span>
<span>  X_S <span class="op">=</span> <span class="va">X_S</span>,       <span class="co"># short event time</span></span>
<span>  D_S <span class="op">=</span> <span class="va">D_S</span>,       <span class="co"># short event indicator</span></span>
<span>  Z1 <span class="op">=</span> <span class="va">Z1</span>,         <span class="co"># continuous covariate 1</span></span>
<span>  Z2 <span class="op">=</span> <span class="va">Z2</span>,         <span class="co"># continuous covariate 2</span></span>
<span>  B <span class="op">=</span> <span class="va">B</span>            <span class="co"># discrete covariate</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a>
</h2>
<p>The package exports the <code>landpred</code> function, which will construct a landpred object given a formula and data. We can supply any number of continuous covariates to this, or a singular discrete covariate, as demonstrated below. Note that short term information needs to be wrapped in a <code>Surv</code> from the <code>survival</code> package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://baolong281.github.io/landpred/">landpred</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create model with continuous covariates and short term information</span></span>
<span><span class="va">obj1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/landpred/man/landpred-package.html" class="external-link">landpred</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">X_L</span>, <span class="va">D_L</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">X_S</span>, <span class="va">D_S</span><span class="op">)</span> <span class="op">+</span> <span class="va">Z1</span> <span class="op">+</span> <span class="va">Z2</span>, data<span class="op">=</span><span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create model with discrete marker and short term information</span></span>
<span><span class="co"># Notice the discrete flag is now enabled, which is false by default.</span></span>
<span><span class="va">obj2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/landpred/man/landpred-package.html" class="external-link">landpred</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">X_L</span>, <span class="va">D_L</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">X_S</span>, <span class="va">D_S</span><span class="op">)</span> <span class="op">+</span> <span class="va">B</span>, data<span class="op">=</span><span class="va">df</span>, discrete<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create model with discrete marker and no short term information</span></span>
<span><span class="co"># Notice the discrete flag is now enabled, which is false by default.</span></span>
<span><span class="va">obj3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/landpred/man/landpred-package.html" class="external-link">landpred</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">X_L</span>, <span class="va">D_L</span><span class="op">)</span> <span class="op">~</span>  <span class="va">B</span>, data<span class="op">=</span><span class="va">df</span>, discrete<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>We will proceed with the object with continuous covariates, and short-term information. We can call <code>summary</code> on this landpred object to get more information from it. Note this landpred object returned by the <code>landpred</code> call serves as a baseline object. To get a model for a specific time ande delta, we must call the <code>get_model</code> function on this object as specified in the <code>summary</code> function. Workflows / functions will be the same in the discrete and continuous case.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">obj1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Landpred Object Summary</span></span>
<span><span class="co">#&gt; Call get_model() to get time-specific model for t0 + tau</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; landpred(formula = Surv(X_L, D_L) ~ Surv(X_S, D_S) + Z1 + Z2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Discrete: FALSE    Short Covariate: TRUE     N: 500</span></span></code></pre></div>
<p>Our <code>get_model</code> function accepts a landpred object as input, and three required parameters, <code>t0</code>, <code>tau</code>, and <code>bw</code>. This returns a landmark prediction model for that specific time and delta. For the coefficients and standard errors of the coefficeints, we call <code>summary</code> on the returned model to get coefficients when no information in the short covariate is provided (has not occured yet). We can also provide <code>t_s</code> to this call to get coefficients for if the short event has occured yet.</p>
<p>We must first choose our bandwidth value. We provide a utility to select this optimal value using K-fold cross validations</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># t0 &lt;- 0.5</span></span>
<span><span class="co"># tau &lt;- 1.5</span></span>
<span><span class="co"># t_s &lt;- 1</span></span>
<span><span class="co"># bw &lt;- optimize_bw(obj1, tau, t_s)</span></span>
<span><span class="co"># bw</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get model</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_model.html">get_model</a></span><span class="op">(</span><span class="va">obj1</span>, t0<span class="op">=</span><span class="fl">1</span>, tau<span class="op">=</span><span class="fl">1.5</span>, bw<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summary with no short covariate</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Continuous Landpred Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients (No short covariate):</span></span>
<span><span class="co">#&gt; Warning in summary.glm(model$glm_noinfo): observations with zero weight not</span></span>
<span><span class="co">#&gt; used for calculating dispersion</span></span>
<span><span class="co">#&gt;             Estimate Std. Error</span></span>
<span><span class="co">#&gt; (Intercept)  1.84640     0.3022</span></span>
<span><span class="co">#&gt; Z1          -1.03234     0.2438</span></span>
<span><span class="co">#&gt; Z2           0.59962     0.2115</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Fit on n=146 observations.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; t0: 1.000      tau: 1.500</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summary with short covariate</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model</span>, t_s<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Continuous Landpred Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients (t_s=0.800000):</span></span>
<span><span class="co">#&gt;             Estimate Std. Error</span></span>
<span><span class="co">#&gt; (Intercept)  12.8095     811.67</span></span>
<span><span class="co">#&gt; Z1           -6.0911     345.42</span></span>
<span><span class="co">#&gt; Z2            7.3664     618.72</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Fit on n=102 observations.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; t0: 1.000      tau: 1.500</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="prediction">Prediction<a class="anchor" aria-label="anchor" href="#prediction"></a>
</h2>
<p>We can also do prediction wiih this model to get survival probabilities for a given observation.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model</span>, newdata<span class="op">=</span><span class="va">df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, , drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">probs</span></span>
<span><span class="co">#&gt; [1] 0.9968329 0.8711052 0.5689068 0.9175203 0.7586372</span></span></code></pre></div>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=landpred" class="external-link">View on CRAN</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing landpred</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Layla Parast <br><small class="roles"> Maintainer </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/baolong281/landpred/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/baolong281/landpred/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/baolong281/landpred" class="external-link"><img src="https://codecov.io/gh/baolong281/landpred/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Layla Parast.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
